import{d as C,r as g,o as S,c as m,a as t,b as e,w as n,e as c,t as p,u as _,f as G,m as j,s as D,g as N,h as k,F as I,i as B,j as v}from"./index-C-CE9rO1.js";import{g as E}from"./nodegroup-Zn-xeRGr.js";import{_ as F}from"./StatusTag.vue_vue_type_script_setup_true_lang-DvcO_2SW.js";import"./index-UDkyn1f5.js";const M={class:"page-container"},P={style:{display:"flex","align-items":"center","justify-content":"space-between"}},V={style:{"font-size":"32px","font-weight":"bold","margin-top":"10px"}},R={style:{display:"flex","align-items":"center","justify-content":"space-between"}},J={style:{"font-size":"32px","font-weight":"bold","margin-top":"10px"}},L={style:{display:"flex","align-items":"center","justify-content":"space-between"}},O={style:{"font-size":"32px","font-weight":"bold","margin-top":"10px",color:"#67c23a"}},T={style:{display:"flex","align-items":"center","justify-content":"space-between"}},$={style:{"font-size":"32px","font-weight":"bold","margin-top":"10px",color:"#f56c6c"}},q={style:{height:"400px",display:"flex","flex-direction":"column",gap:"10px"}},A={style:{display:"flex","align-items":"center",gap:"10px"}},H={style:{color:"#606266"}},Y=C({__name:"Dashboard",setup(K){const l=g({nodeGroupCount:0,instanceCount:0,runningCount:0,failedCount:0}),h=g([]),y=g([]),x=f=>l.value.instanceCount===0?0:Math.round(f/l.value.instanceCount*100),w=async()=>{var f;try{const{data:s}=await E(),r=((f=s.data)==null?void 0:f.nodeGroups)||[];l.value.nodeGroupCount=r.length,h.value=r.map(o=>{var d;return{id:o.id,instanceCount:((d=o.instances)==null?void 0:d.length)||0,targetSize:o.targetSize,minSize:o.minSize,maxSize:o.maxSize}});const a=[];r.forEach(o=>{o.instances&&a.push(...o.instances)}),l.value.instanceCount=a.length,l.value.runningCount=a.filter(o=>o.stage==="Running").length,l.value.failedCount=a.filter(o=>o.status==="Failed").length;const i={Pending:0,Creating:0,Created:0,Joined:0,Running:0,PendingDeletion:0,Deleting:0,Deleted:0};a.forEach(o=>{i[o.stage]=(i[o.stage]||0)+1}),y.value=Object.entries(i).map(([o,d])=>({stage:o,count:d}))}catch(s){console.error("加载数据失败:",s)}};return S(()=>{w()}),(f,s)=>{const r=c("el-icon"),a=c("el-card"),i=c("el-col"),o=c("el-row"),d=c("el-table-column"),b=c("el-table"),z=c("el-progress");return v(),m("div",M,[s[6]||(s[6]=t("h2",{style:{"margin-bottom":"20px"}},"仪表盘",-1)),e(o,{gutter:20,style:{"margin-bottom":"20px"}},{default:n(()=>[e(i,{span:6},{default:n(()=>[e(a,{shadow:"hover"},{default:n(()=>[t("div",P,[t("div",null,[s[0]||(s[0]=t("div",{style:{color:"#909399","font-size":"14px"}},"NodeGroup 总数",-1)),t("div",V,p(l.value.nodeGroupCount),1)]),e(r,{size:48,color:"#409eff"},{default:n(()=>[e(_(G))]),_:1})])]),_:1})]),_:1}),e(i,{span:6},{default:n(()=>[e(a,{shadow:"hover"},{default:n(()=>[t("div",R,[t("div",null,[s[1]||(s[1]=t("div",{style:{color:"#909399","font-size":"14px"}},"Instance 总数",-1)),t("div",J,p(l.value.instanceCount),1)]),e(r,{size:48,color:"#67c23a"},{default:n(()=>[e(_(j))]),_:1})])]),_:1})]),_:1}),e(i,{span:6},{default:n(()=>[e(a,{shadow:"hover"},{default:n(()=>[t("div",L,[t("div",null,[s[2]||(s[2]=t("div",{style:{color:"#909399","font-size":"14px"}},"运行中",-1)),t("div",O,p(l.value.runningCount),1)]),e(r,{size:48,color:"#67c23a"},{default:n(()=>[e(_(D))]),_:1})])]),_:1})]),_:1}),e(i,{span:6},{default:n(()=>[e(a,{shadow:"hover"},{default:n(()=>[t("div",T,[t("div",null,[s[3]||(s[3]=t("div",{style:{color:"#909399","font-size":"14px"}},"失败",-1)),t("div",$,p(l.value.failedCount),1)]),e(r,{size:48,color:"#f56c6c"},{default:n(()=>[e(_(N))]),_:1})])]),_:1})]),_:1})]),_:1}),e(o,{gutter:20},{default:n(()=>[e(i,{span:12},{default:n(()=>[e(a,{shadow:"hover"},{header:n(()=>[...s[4]||(s[4]=[t("div",{style:{"font-weight":"500"}},"NodeGroup 实例统计",-1)])]),default:n(()=>[e(b,{data:h.value,style:{width:"100%"},"max-height":"400"},{default:n(()=>[e(d,{prop:"id",label:"NodeGroup ID",width:"200"}),e(d,{prop:"instanceCount",label:"Instance 数量",align:"center"}),e(d,{prop:"targetSize",label:"目标大小",align:"center"}),e(d,{label:"大小范围",align:"center"},{default:n(({row:u})=>[k(p(u.minSize)+" ~ "+p(u.maxSize),1)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),e(i,{span:12},{default:n(()=>[e(a,{shadow:"hover"},{header:n(()=>[...s[5]||(s[5]=[t("div",{style:{"font-weight":"500"}},"Instance 状态分布",-1)])]),default:n(()=>[t("div",q,[(v(!0),m(I,null,B(y.value,u=>(v(),m("div",{key:u.stage,style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"10px",background:"#f5f7fa","border-radius":"4px"}},[t("div",A,[e(F,{value:u.stage,type:"stage"},null,8,["value"]),t("span",H,p(u.count)+" 个",1)]),e(z,{percentage:x(u.count),"stroke-width":16,"show-text":!1,style:{width:"200px"}},null,8,["percentage"])]))),128))])]),_:1})]),_:1})]),_:1})])}}});export{Y as default};
